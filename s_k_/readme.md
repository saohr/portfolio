# 競馬レースデータ分析ツール

## 概要
このプログラムは、2016年以降の競馬の重賞レースデータを検索・分析するツールです。特定の年度や騎手、距離に基づいた勝利データを取得し、傾向を分析できます。
ターミナル上で動作するので、ターミナルを広く展開することをお勧めします。

## 動作環境
- Python 3.x
- 必要なモジュール: `datetime`, `webbrowser`, `os`, `re`, `collections`

## 構成ファイル
- `main(ver2.0).py`: メインプログラム
- `analyze.py`: レースデータの分析を行うモジュール
- `raceID.py`: レースIDを取得するモジュール
- `request.py`: JRAのレース情報を取得するためのモジュール
- `allRaceData.py`: レースデータを取得するモジュール

## 使い方

### 1. メインメニュー
プログラムを実行すると、以下のメニューが表示されます。
```
【メインメニュー】
重賞結果検索[1], データ分析[2], 終了[その他]:
```
- `[1]` → 重賞レース結果の検索
- `[2]` → 過去のレースデータを分析
- `[その他]` → プログラム終了

### 2. 重賞結果検索
```
【重賞結果検索メニュー】
検索する年度の西暦を整数4桁で入力してください (2016年以降, データ分析[8], 終了[0]):
```
- `[西暦]` → 指定年度のレースデータを取得
- `[8]` → データ分析モードに移行
- `[0]` → プログラム終了

### 3. データ分析
```
【データ分析メニュー】
[1] 過去のデータから検索する,
[2] 年度を指定して検索する,
[0] 終了する:
```
#### 過去のデータ検索
- `[1]` → 騎手とレースの勝利データを検索
- `[2]` → 指定年度の騎手と距離に関する分析

#### 指定年度の分析
```
【まとめて検索:メニュー】
[1] 騎手の距離別の勝利回数を検索する,
[2] 距離を指定して2回以上勝った騎手を表示,
```
- `[1]` → 指定した騎手の特定距離での勝利回数を検索
- `[2]` → 指定した距離で2回以上勝利した騎手を検索

## search_year_distance_jockeys 関数の説明
この関数は、指定年度 (`raceyear`) において、指定された距離 (`seldist`) で **2回以上勝利** した騎手を、勝利数の多い順に出力します。

### **処理の流れ**
1. `get_allrace_data(raceyear)` で指定年度のレースデータを取得
2. 指定距離 (`seldist`) で **勝利した騎手** を抽出
3. `Counter` を使って騎手ごとの勝利数をカウント
4. **2回以上勝っている騎手のみを抽出**
5. **勝利数の多い順にソートして返す**

### **使用例**
```python
result4 = analyzer.search_year_distance_jockeys(2019, format_distance("芝2000メートル"), min_count=2)
```
この場合、2019年の **芝2000メートル** で **2回以上勝利した騎手** が出力されます。

## 注意点
- `format_distance()` を使って距離表記を `芝2,000メートル` のように統一してください。
- `get_allrace_data()` のデータ構造に応じて、フィルタリング条件を適切に設定してください。

## ライセンス
このプログラムは自由に使用・改変可能ですが、再配布時には適切なクレジットを記載してください。

